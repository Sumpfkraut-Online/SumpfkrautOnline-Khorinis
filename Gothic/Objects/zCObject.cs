using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using Gothic.Types;
using WinApi;

namespace Gothic.Objects
{
    public class zCObject : zClass
    {
        public abstract class VarOffsets
        {
            public const int vtbl = 0x00,
            refCtr = 0x04,
            hashIndex = 0x08,
            hashNext = 0x0C,
            objectName = 0x10; //string
        }

        public enum gVobTypes //vftables
        {
            ERROR = 0,
            Item = 8636420,
            Npc = 8640292,
            Mob = 8639700,
            MobFire = 8638876,
            Mover = 8627324,
            MobInter = 8639884,
            MobLockable = 8637628,
            MobContainer = 8637284,
            MobDoor = 8638548,
            MobBed = 8636692,
            MobSwitch = 8636988,
            VobLight = 8624756,

            Freepoint = 0x8643636,

            Vob = 8624508,

            //
            zCVobSpot = Freepoint,
            zString = 8578800,
            //oCMsgConversation = 8642060,
            //zCCSCamera_EventMsgActivate = 0x0082E6FC,
            zCEventMessage = 0x0082E75C,
            //zCEventCore = 0x0082E7BC,
            //oCSpell = 0x00830260,
            //oCVisualFX = 0x0083029C,
            //oCVisualFXAI = 0x00830450,
            //zCAIBase = 0x00830484,
            //oCVisFX_MultiTarget = 0x00830534,
            //zCAICamera = 0x00830690,

            oCAIArrow = 0x0083BFDC,
            oCAIArrowBase = 0x0083BFA4,
            oCAICamera = 0x0083BE7C,
            oCAIDrop = 0x0083C010,
            oCAIHuman = 0x0083BE2C,
            oCAIHuman_Stand = 0x0083BEB0,
            oCAISound = 0x0083BF38,
            oCAIVobMove = 0x0083BF00,
            oCAIVobMoveTorch = 0x0083BF6C,
            oCAniCtrl_Human = 0x0083C064,
            oCAskBox = 0x0083C1C8,
            oCBarrier = ERROR,
            oCBinkPlayer = 0x0082F044,
            oCCSManager = 0x0082E81C,
            oCCSPlayer_zCObject = 0x0082E904,
            oCCSPlayer_zCCSDebugger = 0x0082E8DC,
            oCCSProps = 0x0082E970,
            zCTrigger = 0x0082E9B4,
            oCCollObjectCharacter = 0x0083B5A4,
            oCDoc = 0x0083C220,
            oCDocumentManager = 0x0083B69C,
            oCDummyVobGenerator = 0x0083D3FC,
            oCEmitterKey = ERROR,
            oCGame = 0x0083C28C,
            oCGameInfo = 0x0082F09C,
            oCGuilds = ERROR,
            oCHelp = ERROR,
            oCInfo = 0x0083C44C,
            oCInfoChoice = ERROR,
            oCInfoManager = 0x0083C43C,
            oCInformationManager = ERROR,
            oCItem = 0x0083C804,
            oCItemContainer = 0x0083C4AC,
            oCItemReactModule = ERROR,
            oCLogEntry = ERROR,
            oCLogManager = ERROR,
            oCLogScreen = 0x00830210,
            oCLogTopic = ERROR,
            oCMOB = 0x0083D4D4,
            oCMagFrontier = ERROR,
            oCMag_Book = ERROR,
            oCMapScreen = 0x00830218,
            oCMenuSavegame = 0x0082F1EC,
            oCMenu_ChgKeys = 0x00830104,
            oCMenu_Log = ERROR,
            oCMenu_Main = 0x008300B4,
            oCMenu_Status = ERROR,
            oCMission = 0x0083C8EC,
            oCMissionManager = 0x0083C8E0,
            oCMobBed = 0x0083C914,
            oCMobContainer = 0x0083CB64,
            oCMobDoor = 0x0083D054,
            oCMobFire = 0x0083D19C,
            oCMobInter = 0x0083D58C,
            oCMobItemSlot = ERROR,
            oCMobLadder = 0x0083CF2C,
            oCMobLockable = 0x0083CCBC,
            oCMobMsg = 0x0083D474,
            oCMobSwitch = ERROR,
            oCMobWheel = 0x0083CE04,
            oCMsgAttack = 0x0083DC4C,
            oCMsgConversation = 0x0083DE0C,
            oCMsgDamage = 0x0083DAFC,
            oCMsgMagic = 0x0083DE7C,
            oCMsgManipulate = 0x0083DD9C,
            oCMsgMovement = 0x0083DBDC,
            oCMsgState = 0x0083DD2C,
            oCMsgUseItem = ERROR,
            oCMsgWeapon = 0x0083DB6C,
            oCNews = 0x0083D6DC,
            oCNewsMemory = 0x0083D6D0,
            oCNpc = 0x0083D724,
            oCNpcContainer = 0x0083C644,
            oCNpcFocus = ERROR,
            oCNpcInventory = 0x0083C714,
            oCNpcMessage = 0x0083DA8C,
            oCNpcTalent = 0x0083D710,
            oCNpc_States = 0x0083DF08,
            oCObjectGenerator = 0x0082F484,
            oCParticleControl = ERROR,
            oCPlayerInfo = 0x0082F278,
            oCPortalRoom = ERROR,
            oCPortalRoomManager = ERROR,
            oCRtnCutscene = 0x0083DF80,
            oCRtnEntry = ERROR,
            oCRtnManager = ERROR,
            oCSVM = ERROR,
            oCSVMManager = ERROR,
            oCSavegameInfo = 0x0082F2D8,
            oCSavegameManager = 0x0082F2EC,
            oCShrinkHelper = ERROR,
            oCSkyControler_Barrier = 0x0083C10C,
            oCSpawnManager = ERROR,
            oCSpell = 0x00830260,
            oCStealContainer = 0x0083C574,
            oCSystemInfo = 0x0082F300,
            oCTouchDamage = ERROR,
            oCTrajectory = ERROR,
            oCTriggerChangeLevel = 0x0082F384,
            oCTriggerScript = 0x0082F404,
            oCViewDialogInventory_zCObject = 0x0083B77C,
            oCViewDialogInventory_zCViewBase = 0x0083B754,
            oCViewDialogInventory = 0x0083B74C,
            oCViewDialogItem_zCObject = 0x0083B804,
            oCViewDialogItem_zCViewBase = 0x0083B7D8,
            oCViewDialogItem = 0x0083B7D0,
            oCViewDialogItemContainer_zCObject = 0x0083B88C,
            oCViewDialogItemContainer_zCViewBase = 0x0083B860,
            oCViewDialogItemContainer = 0x0083B858,
            oCViewDialogStealContainer_zCObject = 0x0083B914,
            oCViewDialogStealContainer_zCViewBase = 0x0083B8EC,
            oCViewDialogStealContainer = 0x0083B8E4,
            oCViewDialogTrade_zCObject = 0x0083B9A4,
            oCViewDialogTrade_zCViewBase = 0x0083B978,
            oCViewDialogTrade = 0x0083B970,
            oCViewDocument_zCObject = 0x0083BA3C,
            oCViewDocument_zCViewBase = 0x0083BA10,
            oCViewDocument = 0x0083BA08,
            oCViewDocumentMap_zCObject = 0x0083BACC,
            oCViewDocumentMap_zCViewBase = 0x0083BAA4,
            oCViewDocumentMap = 0x0083BA9C,
            oCViewGothicProgressBar_zCViewBase = 0x0083C36C,
            oCViewGothicProgressBar_zCInputCallback = 0x0083C364,
            oCViewStatusBar_zCViewBase = 0x0082F52C,
            oCViewStatusBar_zCInputCallback = 0x0082F520,
            oCVisFX_MultiTarget = 0x00830534,
            oCVisualFX = 0x0083029C,
            oCVisualFXAI = 0x00830450,
            oCVob = 0x0083DFE4,
            oCWay = 0x0083E138,
            oCWaypoint = 0x0083E120,
            oCWorld = 0x0083E174,
            oCWorldTimer = ERROR,
            oCZoneMusic = ERROR,
            oCZoneMusicDefault = ERROR,
            oSMenuInfoAttribute = ERROR,
            oSMenuInfoTalent = ERROR,
            oTGilValues = ERROR,

            zCAIBase = 0x00830484,
            zCAICamera = 0x00830690,
            zCAIPlayer = 0x0083151C,
            zCAccount = ERROR,
            zCAccountInfo = ERROR,
            zCActiveSnd = ERROR,
            zCArchiver = 0x0083184C,
            zCArchiverBinSafe = 0x008316D4,
            zCArchiverFactory = ERROR,
            zCArchiverGeneric = 0x008319DC,
            zCBBox3DSorterBase = 0x0083ACDC,
            zCBinTree3DS = ERROR,
            zCBinkPlayer = 0x0082F594,
            zCBspBase = ERROR,
            zCBspLeaf = ERROR,
            zCBspNode = ERROR,
            zCBspSector = ERROR,
            zCBspTree = ERROR,
            zCBuffer = 0x0082F5F0,
            zCCBspNode = ERROR,
            zCCBspTree = ERROR,
            zCCSAtomicBlock = 0x0082EB5C,
            zCCSBlock = 0x0082EBC4,
            zCCSBlockBase = 0x0082EC94,
            zCCSBlockPosition = 0x0082ED78,
            zCCSCamera = 0x008308EC,
            zCCSCamera_EventMsg = 0x0083096C,
            zCCSCamera_EventMsgActivate = 0x0082E6FC,
            zCCSCutsceneContext = 0x0082EA4C,
            zCCSDebugger = 0x0082EF9C,
            zCCSLib = 0x0082EE60,
            zCCSManager = 0x0082EE8C,
            zCCSPlayer_zCObject = 0x0082EF44,
            zCCSPlayer_zCCSDebugger = 0x0082EF20,
            zCCSPoolItem_zSTRING = 0x0082EFEC,
            zCCSPoolItem_zCObject = 0x0082EFD8,
            zCCSProps = 0x0082F00C,
            zCCSRole_zCObject = 0x0082ED00,
            zCCSRole_zSTRING = 0x0082ECF8,
            zCCSSyncBlock = 0x0082EC2C,
            zCCacheBase = 0x0083305C,
            zCCamTrj_KeyFrame = 0x00830874,
            zCCamera = ERROR,
            zCChecksum = ERROR,
            zCClassDef = ERROR,
            zCCodeMaster = 0x00839D2C,
            zCCollObjectBase = ERROR,
            zCCollObjectBoxBlocker = ERROR,
            zCCollObjectBoxPassThrough = ERROR,
            zCCollObjectCharacter = 0x00831EA0,
            zCCollObjectComplex = ERROR,
            zCCollObjectLevelPolys = ERROR,
            zCCollObjectPoint = ERROR,
            zCCollObjectProjectile = ERROR,
            zCCollObjectUndef = ERROR,
            zCCollisionDetector = 0x00831D4C,
            zCCollisionObject = 0x00831D78,
            zCCollisionObjectDef = ERROR,
            zCCollisionReport = 0x00831D44,
            zCCombine = ERROR,
            zCConDat = ERROR,
            zCConsole = 0x0083E220,
            zCConvexCollisionCache = ERROR,
            zCConvexPrimitive = 0x00831F78,
            zCConvexPrimitiveEllipsoid = ERROR,
            zCConvexPrimitiveScaleTrans = ERROR,
            zCConvexPrimitiveUnitSphere = ERROR,
            zCCriticalSection = 0x008331F0,
            zCCubicPolynomial = ERROR,
            zCCutscene = 0x0082ED8C,
            zCDXTCCache_D3D = ERROR,
            zCDecal = 0x00832084,
            zCDetectLedgeReport = ERROR,
            zCDrvProperties_MSS = ERROR,
            zCDynVobLightCacheElement = ERROR,
            zCEarthquake = 0x00839F94,
            zCEffect = 0x008303DC,
            zCEngine = 0x00832100,
            zCEvMsgCutscene = 0x0082ED14,
            zCEventCommon = ERROR,
            zCEventCore = 0x0082E7BC,
            zCEventManager = 0x0083E23C,
            zCEventMover = ERROR,
            zCEventMusicControler = ERROR,
            zCEventScreenFX = ERROR,
            zCExceptionHandler = ERROR,
            zCFFT = 0x00832128,
            zCFPUControler = ERROR,
            zCFile3DS = ERROR,
            zCFileBIN = ERROR,
            zCFileCSV = 0x0082F92C,
            zCFileQuakeBSP = ERROR,
            zCFlash = 0x00830A64,
            zCFlash_zCBolt = 0x00830A04,
            zCFont = ERROR,
            zCFontMan = ERROR,
            zCGameInfo = 0x0082FA38,
            zCGfx = ERROR,
            zCHandleManager = ERROR,
            zCInput = 0x00830AD4,
            zCInputCallback = 0x0083E2FC,
            zCInput_Win32 = 0x00830B64,
            zCKBSpline = ERROR,
            zCLensFlareFX = 0x008321E4,
            zCLightMap = 0x008331B4,
            zCLightning_zCBolt = ERROR,
            zCLineCache = ERROR,
            zCMalloc = 0x00832228,
            zCMallocGeneric = ERROR,
            zCMapDetailTexture = ERROR,
            zCMaterial = 0x00832214,
            zCMemPoolBase = ERROR,
            zCMenu = 0x00830C3C,
            zCMenuItem = 0x0083101C,
            zCMenuItemButton_zCViewBase = 0x00830CAC,
            zCMenuItemButton_zCInputCallback = 0x00830CA4,
            zCMenuItemChoice_zCViewBase = 0x00830DCC,
            zCMenuItemChoice_zCInputCallback = 0x00830DC4,
            zCMenuItemInput_zCViewBase = 0x00830EF4,
            zCMenuItemInput_zCInputCallback = 0x00830EE8,
            zCMenuItemList_zCViewBase = 0x00830D3C,
            zCMenuItemList_zCInputCallback = 0x00830D34,
            zCMenuItemSlider_zCViewBase = 0x00830E5C,
            zCMenuItemSlider_zCInputCallback = 0x00830E54,
            zCMenuItemText_zCViewBase = 0x00830F84,
            zCMenuItemText_zCInputCallback = 0x00830F7C,
            zCMesh3DS = ERROR,
            zCMesh = 0x008322BC,
            zCMeshOctreeNode = ERROR,
            zCMeshSoftSkin = 0x00832964,
            zCMessageFilter = ERROR,
            zCMgcEigenD = ERROR,
            zCModel = 0x0083234C,
            zCModelAni = 0x00832498,
            zCModelAniActive = ERROR,
            zCModelAniEvent = ERROR,
            zCModelConvertFileHandler = 0x008324B0,
            zCModelMeshLib = 0x00832438,
            zCModelNode = ERROR,
            zCModelNodeInst = ERROR,
            zCModelPrototype = ERROR,
            zCModelTexAniState = ERROR,
            zCMorphMesh = 0x008324D4,
            zCMorphMeshAni = ERROR,
            zCMorphMeshConvertFileHandler = ERROR,
            zCMorphMeshProto = ERROR,
            zCMovementTracker = ERROR,
            zCMover = 0x0083A47C,
            zCMusicControler = ERROR,
            zCMusicJingle = 0x0083113C,
            zCMusicSys_DirectMusic = 0x008310E4,
            zCMusicSys_Dummy = ERROR,
            zCMusicSystem = 0x0083115C,
            zCMusicTheme = 0x008310C4,
            zCMusicTheme_DM = 0x008310D0,
            zCMutex = 0x00833210,
            zCNet = 0x0082FA80,
            zCNetEventManager = 0x0082FACC,
            zCNetHost = 0x0082FB54,
            zCNetManager = 0x0082FB70,
            zCNetMessage = 0x0082FBA8,
            zCNetMessageQueue = ERROR,
            zCNetSession = 0x0082FBB0,
            zCNetStatistics = 0x0082FA88,
            zCNetVersion = 0x0082FBB8,
            zCNetVobControl = 0x0082FBEC,
            zCOBBox3D = ERROR,
            zCOLOR = ERROR,
            zCObject = 0x0082E89C,
            zCObjectFactory = 0x0082F148,
            zCOption = 0x0082FC30,
            zCOptionEntry = ERROR,
            zCOutdoorRainFX = ERROR,
            zCPFXControler = ERROR,
            zCPFXPerFrameCallback = ERROR,
            zCPar_DataStack = ERROR,
            zCPar_File = ERROR,
            zCPar_Stack = ERROR,
            zCPar_StringTable = ERROR,
            zCPar_Symbol = ERROR,
            zCPar_SymbolTable = ERROR,
            zCPar_TreeNode = ERROR,
            zCParser = ERROR,
            zCParticleEmitter = ERROR,
            zCParticleFX = 0x008325C4,
            zCPatch = ERROR,
            zCPatchMap = ERROR,
            zCPathSearch = ERROR,
            zCPlayerGroup = 0x0082FC50,
            zCPlayerInfo = 0x0082FC6C,
            zCPluecker = ERROR,
            zCPolyStrip = 0x008326B4,
            zCPolygon = ERROR,
            zCPortal = ERROR,
            zCPose = ERROR,
            zCPosition = ERROR,
            zCPositionKey = ERROR,
            zCPrime = ERROR,
            zCProgMeshBuilder = ERROR,
            zCProgMeshConvertFileHandler = ERROR,
            zCProgMeshProto = 0x008329CC
        }


        public zCObject(int address)
            : base(address)
        { }

        public zCObject()
        {

        }
        public gVobTypes VTBL
        {
            get { return (gVobTypes)Process.ReadInt(Address + VarOffsets.vtbl); }
            set { Process.Write((int)value, Address + VarOffsets.vtbl); }
        }

        public int refCtr
        {
            get { return Process.ReadInt(Address + VarOffsets.refCtr); }
            set { Process.Write(value, Address + VarOffsets.refCtr); }
        }

        public zString ObjectName
        {
            get { return new zString(Address + VarOffsets.objectName); }
        }
    }
}
